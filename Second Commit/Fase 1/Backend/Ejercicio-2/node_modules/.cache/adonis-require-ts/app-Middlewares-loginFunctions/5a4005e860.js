"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.verifyPassword = exports.hashPassword = exports.getPasswordByEmail = exports.existEmail = void 0;
const argon2_1 = __importDefault(require("argon2"));
const UsersDatabase_1 = global[Symbol.for('ioc.use')]("Database/UsersDatabase");
const existEmail = (email) => {
    let exists = false;
    UsersDatabase_1.allUsers.forEach(user => {
        if (user.email === email) {
            exists = true;
        }
    });
    return exists;
};
exports.existEmail = existEmail;
const getPasswordByEmail = (email) => {
    let userPassword = "";
    UsersDatabase_1.allUsers.forEach(user => {
        if (user.email == email) {
            userPassword = user.password;
        }
    });
    return userPassword;
};
exports.getPasswordByEmail = getPasswordByEmail;
const hashPassword = async (password) => {
    const hashedPassword = await argon2_1.default.hash(password);
    return hashedPassword;
};
exports.hashPassword = hashPassword;
const verifyPassword = async (hashedPassword, password) => {
    const correct = await argon2_1.default.verify(hashedPassword, password);
    return correct;
};
exports.verifyPassword = verifyPassword;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9naW5GdW5jdGlvbnMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJsb2dpbkZ1bmN0aW9ucy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxvREFBNEI7QUFDNUIsZ0ZBQWtEO0FBRTNDLE1BQU0sVUFBVSxHQUFHLENBQUMsS0FBYSxFQUFFLEVBQUU7SUFFMUMsSUFBSSxNQUFNLEdBQVksS0FBSyxDQUFBO0lBRTNCLHdCQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBRXRCLElBQUcsSUFBSSxDQUFDLEtBQUssS0FBSyxLQUFLLEVBQUM7WUFFdEIsTUFBTSxHQUFHLElBQUksQ0FBQTtTQUVkO0lBRUgsQ0FBQyxDQUFDLENBQUM7SUFFSCxPQUFPLE1BQU0sQ0FBQztBQUNoQixDQUFDLENBQUE7QUFmWSxRQUFBLFVBQVUsY0FldEI7QUFFTSxNQUFNLGtCQUFrQixHQUFHLENBQUMsS0FBYSxFQUFFLEVBQUU7SUFFbEQsSUFBSSxZQUFZLEdBQVcsRUFBRSxDQUFDO0lBRTlCLHdCQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFO1FBRXRCLElBQUcsSUFBSSxDQUFDLEtBQUssSUFBSSxLQUFLLEVBQUM7WUFFckIsWUFBWSxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUM7U0FFOUI7SUFFSCxDQUFDLENBQUMsQ0FBQztJQUVILE9BQU8sWUFBWSxDQUFDO0FBQ3RCLENBQUMsQ0FBQTtBQWZZLFFBQUEsa0JBQWtCLHNCQWU5QjtBQUVNLE1BQU0sWUFBWSxHQUFHLEtBQUssRUFBRSxRQUFnQixFQUFFLEVBQUU7SUFFckQsTUFBTSxjQUFjLEdBQVcsTUFBTSxnQkFBTSxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUUzRCxPQUFPLGNBQWMsQ0FBQztBQUN4QixDQUFDLENBQUE7QUFMWSxRQUFBLFlBQVksZ0JBS3hCO0FBRU0sTUFBTSxjQUFjLEdBQUcsS0FBSyxFQUFFLGNBQXNCLEVBQUUsUUFBZ0IsRUFBRSxFQUFFO0lBRS9FLE1BQU0sT0FBTyxHQUFZLE1BQU0sZ0JBQU0sQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBRXZFLE9BQU8sT0FBTyxDQUFDO0FBRWpCLENBQUMsQ0FBQTtBQU5ZLFFBQUEsY0FBYyxrQkFNMUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXJnb24yIGZyb20gXCJhcmdvbjJcIjtcbmltcG9ydCB7IGFsbFVzZXJzIH0gZnJvbSBcIkRhdGFiYXNlL1VzZXJzRGF0YWJhc2VcIjtcblxuZXhwb3J0IGNvbnN0IGV4aXN0RW1haWwgPSAoZW1haWw6IHN0cmluZykgPT4ge1xuXG4gIGxldCBleGlzdHM6IGJvb2xlYW4gPSBmYWxzZVxuXG4gIGFsbFVzZXJzLmZvckVhY2godXNlciA9PiB7XG5cbiAgICBpZih1c2VyLmVtYWlsID09PSBlbWFpbCl7XG5cbiAgICAgIGV4aXN0cyA9IHRydWVcblxuICAgIH1cblxuICB9KTtcblxuICByZXR1cm4gZXhpc3RzO1xufVxuXG5leHBvcnQgY29uc3QgZ2V0UGFzc3dvcmRCeUVtYWlsID0gKGVtYWlsOiBzdHJpbmcpID0+IHtcblxuICBsZXQgdXNlclBhc3N3b3JkOiBzdHJpbmcgPSBcIlwiO1xuXG4gIGFsbFVzZXJzLmZvckVhY2godXNlciA9PiB7XG5cbiAgICBpZih1c2VyLmVtYWlsID09IGVtYWlsKXtcblxuICAgICAgdXNlclBhc3N3b3JkID0gdXNlci5wYXNzd29yZDtcblxuICAgIH1cblxuICB9KTtcblxuICByZXR1cm4gdXNlclBhc3N3b3JkO1xufVxuXG5leHBvcnQgY29uc3QgaGFzaFBhc3N3b3JkID0gYXN5bmMgKHBhc3N3b3JkOiBzdHJpbmcpID0+IHtcblxuICBjb25zdCBoYXNoZWRQYXNzd29yZDogc3RyaW5nID0gYXdhaXQgYXJnb24yLmhhc2gocGFzc3dvcmQpO1xuXG4gIHJldHVybiBoYXNoZWRQYXNzd29yZDtcbn1cblxuZXhwb3J0IGNvbnN0IHZlcmlmeVBhc3N3b3JkID0gYXN5bmMgKGhhc2hlZFBhc3N3b3JkOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcpID0+IHtcblxuICBjb25zdCBjb3JyZWN0OiBib29sZWFuID0gYXdhaXQgYXJnb24yLnZlcmlmeShoYXNoZWRQYXNzd29yZCwgcGFzc3dvcmQpO1xuXG4gIHJldHVybiBjb3JyZWN0O1xuXG59XG4iXX0=