"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.register = exports.login = void 0;
const loginFunctions_1 = global[Symbol.for('ioc.use')]("App/Middlewares/loginFunctions");
const User_1 = global[Symbol.for('ioc.use')]("App/Models/User");
const UsersDatabase_1 = global[Symbol.for('ioc.use')]("Database/UsersDatabase");
const login = async (email, password) => {
    console.log('Compruebo el email: ' + email);
    if ((0, loginFunctions_1.existEmail)(email)) {
        const userPassword = (0, loginFunctions_1.getPasswordByEmail)(email);
        if (await (0, loginFunctions_1.verifyPassword)(userPassword, password)) {
            return 1;
        }
        return -2;
    }
    return -1;
};
exports.login = login;
const register = async (email, password) => {
    if (!(0, loginFunctions_1.existEmail)(email)) {
        const newUser = new User_1.User(email, await (0, loginFunctions_1.hashPassword)(password));
        UsersDatabase_1.allUsers.push(newUser);
        return true;
    }
    return false;
};
exports.register = register;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTG9naW5TZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiTG9naW5TZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLHlGQUE2RztBQUM3RyxnRUFBc0M7QUFDdEMsZ0ZBQWtEO0FBRTNDLE1BQU0sS0FBSyxHQUFHLEtBQUssRUFBRSxLQUFhLEVBQUUsUUFBZ0IsRUFBRSxFQUFFO0lBRTdELE9BQU8sQ0FBQyxHQUFHLENBQUMsc0JBQXNCLEdBQUcsS0FBSyxDQUFDLENBQUE7SUFFM0MsSUFBRyxJQUFBLDJCQUFVLEVBQUMsS0FBSyxDQUFDLEVBQUM7UUFFbkIsTUFBTSxZQUFZLEdBQUcsSUFBQSxtQ0FBa0IsRUFBQyxLQUFLLENBQUMsQ0FBQztRQUUvQyxJQUFHLE1BQU0sSUFBQSwrQkFBYyxFQUFDLFlBQVksRUFBRSxRQUFRLENBQUMsRUFBQztZQUU5QyxPQUFPLENBQUMsQ0FBQTtTQUVUO1FBRUQsT0FBTyxDQUFDLENBQUMsQ0FBQztLQUVYO0lBRUQsT0FBTyxDQUFDLENBQUMsQ0FBQztBQUNaLENBQUMsQ0FBQTtBQW5CWSxRQUFBLEtBQUssU0FtQmpCO0FBRU0sTUFBTSxRQUFRLEdBQUcsS0FBSyxFQUFFLEtBQWEsRUFBRSxRQUFnQixFQUFFLEVBQUU7SUFFaEUsSUFBRyxDQUFDLElBQUEsMkJBQVUsRUFBQyxLQUFLLENBQUMsRUFBQztRQUVwQixNQUFNLE9BQU8sR0FBUyxJQUFJLFdBQUksQ0FBQyxLQUFLLEVBQUUsTUFBTSxJQUFBLDZCQUFZLEVBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztRQUVwRSx3QkFBUSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUV2QixPQUFPLElBQUksQ0FBQztLQUViO0lBRUQsT0FBTyxLQUFLLENBQUM7QUFDZixDQUFDLENBQUE7QUFiWSxRQUFBLFFBQVEsWUFhcEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBleGlzdEVtYWlsLCBnZXRQYXNzd29yZEJ5RW1haWwsIGhhc2hQYXNzd29yZCwgdmVyaWZ5UGFzc3dvcmQgfSBmcm9tIFwiQXBwL01pZGRsZXdhcmVzL2xvZ2luRnVuY3Rpb25zXCJcbmltcG9ydCB7IFVzZXIgfSBmcm9tIFwiQXBwL01vZGVscy9Vc2VyXCJcbmltcG9ydCB7IGFsbFVzZXJzIH0gZnJvbSBcIkRhdGFiYXNlL1VzZXJzRGF0YWJhc2VcIjtcblxuZXhwb3J0IGNvbnN0IGxvZ2luID0gYXN5bmMgKGVtYWlsOiBzdHJpbmcsIHBhc3N3b3JkOiBzdHJpbmcpID0+IHtcblxuICBjb25zb2xlLmxvZygnQ29tcHJ1ZWJvIGVsIGVtYWlsOiAnICsgZW1haWwpXG5cbiAgaWYoZXhpc3RFbWFpbChlbWFpbCkpe1xuXG4gICAgY29uc3QgdXNlclBhc3N3b3JkID0gZ2V0UGFzc3dvcmRCeUVtYWlsKGVtYWlsKTtcblxuICAgIGlmKGF3YWl0IHZlcmlmeVBhc3N3b3JkKHVzZXJQYXNzd29yZCwgcGFzc3dvcmQpKXtcblxuICAgICAgcmV0dXJuIDFcblxuICAgIH1cblxuICAgIHJldHVybiAtMjtcblxuICB9XG5cbiAgcmV0dXJuIC0xO1xufVxuXG5leHBvcnQgY29uc3QgcmVnaXN0ZXIgPSBhc3luYyAoZW1haWw6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZykgPT4ge1xuXG4gIGlmKCFleGlzdEVtYWlsKGVtYWlsKSl7XG5cbiAgICBjb25zdCBuZXdVc2VyOiBVc2VyID0gbmV3IFVzZXIoZW1haWwsIGF3YWl0IGhhc2hQYXNzd29yZChwYXNzd29yZCkpO1xuXG4gICAgYWxsVXNlcnMucHVzaChuZXdVc2VyKTtcblxuICAgIHJldHVybiB0cnVlO1xuXG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59XG4iXX0=